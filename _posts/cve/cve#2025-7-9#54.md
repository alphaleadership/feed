 
title: cve fuite du 2025-7-9
date: 2025-7-9
lien: "https://cvefeed.io/vuln/detail/CVE-2025-38250"
categories:
  - cve
---

CVE ID : CVE-2025-38250

Published :  July 9
2025
11:15 a.m. | 4 hours
50 minutes ago

Description : In the Linux kernel
the following vulnerability has been resolved:

Bluetooth: hci_core: Fix use-after-free in vhci_flush()

syzbot reported use-after-free in vhci_flush() without repro. [0]

From the splat
a thread close()d a vhci file descriptor while
its device was being used by iotcl() on another thread.

Once the last fd refcnt is released
vhci_release() calls
hci_unregister_dev()
hci_free_dev()
and kfree() for struct
vhci_data
which is set to hci_dev->dev->driver_data.

The problem is that there is no synchronisation after unlinking
hdev from hci_dev_list in hci_unregister_dev().  There might be
another thread still accessing the hdev which was fetched before
the unlink operation.

We can use SRCU for such synchronisation.

Let's run hci_dev_reset() under SRCU and wait for its completion
in hci_unregister_dev().

Another option would be to restore hci_dev->destruct()
which was
removed in commit 587ae086f6e4 ("Bluetooth: Remove unused
hci-destruct cb").  However
this would not be a good solution
as
we should not run hci_unregister_dev() while there are in-flight
ioctl() requests
which could lead to another data-race KCSAN splat.

Note that other drivers seem to have the same problem
for exmaple
virtbt_remove().

[0]:
BUG: KASAN: slab-use-after-free in skb_queue_empty_lockless include/linux/skbuff.h:1891 [inline]
BUG: KASAN: slab-use-after-free in skb_queue_purge_reason+0x99/0x360 net/core/skbuff.c:3937
Read of size 8 at addr ffff88807cb8d858 by task syz.1.219/6718

CPU: 1 UID: 0 PID: 6718 Comm: syz.1.219 Not tainted 6.16.0-rc1-syzkaller-00196-g08207f42d3ff #0 PREEMPT(full)
Hardware name: Google Google Compute Engine/Google Compute Engine
BIOS Google 05/07/2025
Call Trace:
 
 dump_stack_lvl+0x189/0x250 lib/dump_stack.c:120
 print_address_description mm/kasan/report.c:408 [inline]
 print_report+0xd2/0x2b0 mm/kasan/report.c:521
 kasan_report+0x118/0x150 mm/kasan/report.c:634
 skb_queue_empty_lockless include/linux/skbuff.h:1891 [inline]
 skb_queue_purge_reason+0x99/0x360 net/core/skbuff.c:3937
 skb_queue_purge include/linux/skbuff.h:3368 [inline]
 vhci_flush+0x44/0x50 drivers/bluetooth/hci_vhci.c:69
 hci_dev_do_reset net/bluetooth/hci_core.c:552 [inline]
 hci_dev_reset+0x420/0x5c0 net/bluetooth/hci_core.c:592
 sock_do_ioctl+0xd9/0x300 net/socket.c:1190
 sock_ioctl+0x576/0x790 net/socket.c:1311
 vfs_ioctl fs/ioctl.c:51 [inline]
 __do_sys_ioctl fs/ioctl.c:907 [inline]
 __se_sys_ioctl+0xf9/0x170 fs/ioctl.c:893
 do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]
 do_syscall_64+0xfa/0x3b0 arch/x86/entry/syscall_64.c:94
 entry_SYSCALL_64_after_hwframe+0x77/0x7f
RIP: 0033:0x7fcf5b98e929
Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05  3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007fcf5c7b9038 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
RAX: ffffffffffffffda RBX: 00007fcf5bbb6160 RCX: 00007fcf5b98e929
RDX: 0000000000000000 RSI: 00000000400448cb RDI: 0000000000000009
RBP: 00007fcf5ba10b39 R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
R13: 0000000000000000 R14: 00007fcf5bbb6160 R15: 00007ffd6353d528
 

Allocated by task 6535:
 kasan_save_stack mm/kasan/common.c:47 [inline]
 kasan_save_track+0x3e/0x80 mm/kasan/common.c:68
 poison_kmalloc_redzone mm/kasan/common.c:377 [inline]
 __kasan_kmalloc+0x93/0xb0 mm/kasan/common.c:394
 kasan_kmalloc include/linux/kasan.h:260 [inline]
 __kmalloc_cache_noprof+0x230/0x3d0 mm/slub.c:4359
 kmalloc_noprof include/linux/slab.h:905 [inline]
 kzalloc_noprof include/linux/slab.h:1039 [inline]
 vhci_open+0x57/0x360 drivers/bluetooth/hci_vhci.c:635
 misc_open+0x2bc/0x330 drivers/char/misc.c:161
 chrdev_open+0x4c9/0x5e0 fs/char_dev.c:414
 do_dentry_open+0xdf0/0x1970 fs/open.c:964
 vfs_open+0x3b/0x340 fs/open.c:1094
 do_open fs/namei.c:3887 [inline]
 path_openat+0x2ee5/0x3830 fs/name
---truncated---

Severity: 0.0 | NA

Visit the link for more details
such as CVSS details
affected products
timeline
and more...


Autres fuites ce jour :
- [https://cvefeed.io/vuln/detail/CVE-2024-10391](https://cvefeed.io/vuln/detail/CVE-2024-10391)
- [https://cvefeed.io/vuln/detail/CVE-2025-0139](https://cvefeed.io/vuln/detail/CVE-2025-0139)
- [https://cvefeed.io/vuln/detail/CVE-2025-0140](https://cvefeed.io/vuln/detail/CVE-2025-0140)
- [https://cvefeed.io/vuln/detail/CVE-2025-0141](https://cvefeed.io/vuln/detail/CVE-2025-0141)
- [https://cvefeed.io/vuln/detail/CVE-2025-0646](https://cvefeed.io/vuln/detail/CVE-2025-0646)
- [https://cvefeed.io/vuln/detail/CVE-2025-6970](https://cvefeed.io/vuln/detail/CVE-2025-6970)
- [https://cvefeed.io/vuln/detail/CVE-2025-6975](https://cvefeed.io/vuln/detail/CVE-2025-6975)
- [https://cvefeed.io/vuln/detail/CVE-2025-6976](https://cvefeed.io/vuln/detail/CVE-2025-6976)
- [https://cvefeed.io/vuln/detail/CVE-2025-53624](https://cvefeed.io/vuln/detail/CVE-2025-53624)
- [https://cvefeed.io/vuln/detail/CVE-2025-6376](https://cvefeed.io/vuln/detail/CVE-2025-6376)
- [https://cvefeed.io/vuln/detail/CVE-2025-6377](https://cvefeed.io/vuln/detail/CVE-2025-6377)
- [https://cvefeed.io/vuln/detail/CVE-2025-52357](https://cvefeed.io/vuln/detail/CVE-2025-52357)
- [https://cvefeed.io/vuln/detail/CVE-2021-27961](https://cvefeed.io/vuln/detail/CVE-2021-27961)
- [https://cvefeed.io/vuln/detail/CVE-2025-36599](https://cvefeed.io/vuln/detail/CVE-2025-36599)
- [https://cvefeed.io/vuln/detail/CVE-2025-53620](https://cvefeed.io/vuln/detail/CVE-2025-53620)
- [https://cvefeed.io/vuln/detail/CVE-2025-53548](https://cvefeed.io/vuln/detail/CVE-2025-53548)
- [https://cvefeed.io/vuln/detail/CVE-2025-44525](https://cvefeed.io/vuln/detail/CVE-2025-44525)
- [https://cvefeed.io/vuln/detail/CVE-2025-53645](https://cvefeed.io/vuln/detail/CVE-2025-53645)
- [https://cvefeed.io/vuln/detail/CVE-2025-53675](https://cvefeed.io/vuln/detail/CVE-2025-53675)
- [https://cvefeed.io/vuln/detail/CVE-2025-53676](https://cvefeed.io/vuln/detail/CVE-2025-53676)
- [https://cvefeed.io/vuln/detail/CVE-2025-53677](https://cvefeed.io/vuln/detail/CVE-2025-53677)
- [https://cvefeed.io/vuln/detail/CVE-2025-53678](https://cvefeed.io/vuln/detail/CVE-2025-53678)
- [https://cvefeed.io/vuln/detail/CVE-2025-53742](https://cvefeed.io/vuln/detail/CVE-2025-53742)
- [https://cvefeed.io/vuln/detail/CVE-2025-53743](https://cvefeed.io/vuln/detail/CVE-2025-53743)
- [https://cvefeed.io/vuln/detail/CVE-2025-7381](https://cvefeed.io/vuln/detail/CVE-2025-7381)
- [https://cvefeed.io/vuln/detail/CVE-2025-53667](https://cvefeed.io/vuln/detail/CVE-2025-53667)
- [https://cvefeed.io/vuln/detail/CVE-2025-53668](https://cvefeed.io/vuln/detail/CVE-2025-53668)
- [https://cvefeed.io/vuln/detail/CVE-2025-53669](https://cvefeed.io/vuln/detail/CVE-2025-53669)
- [https://cvefeed.io/vuln/detail/CVE-2025-53670](https://cvefeed.io/vuln/detail/CVE-2025-53670)
- [https://cvefeed.io/vuln/detail/CVE-2025-53671](https://cvefeed.io/vuln/detail/CVE-2025-53671)
- [https://cvefeed.io/vuln/detail/CVE-2025-53672](https://cvefeed.io/vuln/detail/CVE-2025-53672)
- [https://cvefeed.io/vuln/detail/CVE-2025-53673](https://cvefeed.io/vuln/detail/CVE-2025-53673)
- [https://cvefeed.io/vuln/detail/CVE-2025-53674](https://cvefeed.io/vuln/detail/CVE-2025-53674)
- [https://cvefeed.io/vuln/detail/CVE-2025-53663](https://cvefeed.io/vuln/detail/CVE-2025-53663)
- [https://cvefeed.io/vuln/detail/CVE-2025-53664](https://cvefeed.io/vuln/detail/CVE-2025-53664)
- [https://cvefeed.io/vuln/detail/CVE-2025-53665](https://cvefeed.io/vuln/detail/CVE-2025-53665)
- [https://cvefeed.io/vuln/detail/CVE-2025-53666](https://cvefeed.io/vuln/detail/CVE-2025-53666)
- [https://cvefeed.io/vuln/detail/CVE-2025-53660](https://cvefeed.io/vuln/detail/CVE-2025-53660)
- [https://cvefeed.io/vuln/detail/CVE-2025-53661](https://cvefeed.io/vuln/detail/CVE-2025-53661)
- [https://cvefeed.io/vuln/detail/CVE-2025-53662](https://cvefeed.io/vuln/detail/CVE-2025-53662)
- [https://cvefeed.io/vuln/detail/CVE-2025-53659](https://cvefeed.io/vuln/detail/CVE-2025-53659)
- [https://cvefeed.io/vuln/detail/CVE-2025-53657](https://cvefeed.io/vuln/detail/CVE-2025-53657)
- [https://cvefeed.io/vuln/detail/CVE-2025-53658](https://cvefeed.io/vuln/detail/CVE-2025-53658)
- [https://cvefeed.io/vuln/detail/CVE-2025-1112](https://cvefeed.io/vuln/detail/CVE-2025-1112)
- [https://cvefeed.io/vuln/detail/CVE-2025-2670](https://cvefeed.io/vuln/detail/CVE-2025-2670)
- [https://cvefeed.io/vuln/detail/CVE-2025-52364](https://cvefeed.io/vuln/detail/CVE-2025-52364)
- [https://cvefeed.io/vuln/detail/CVE-2025-53546](https://cvefeed.io/vuln/detail/CVE-2025-53546)
- [https://cvefeed.io/vuln/detail/CVE-2025-7204](https://cvefeed.io/vuln/detail/CVE-2025-7204)
- [https://cvefeed.io/vuln/detail/CVE-2025-6514](https://cvefeed.io/vuln/detail/CVE-2025-6514)
- [https://cvefeed.io/vuln/detail/CVE-2025-38246](https://cvefeed.io/vuln/detail/CVE-2025-38246)
- [https://cvefeed.io/vuln/detail/CVE-2025-38247](https://cvefeed.io/vuln/detail/CVE-2025-38247)
- [https://cvefeed.io/vuln/detail/CVE-2025-38248](https://cvefeed.io/vuln/detail/CVE-2025-38248)
- [https://cvefeed.io/vuln/detail/CVE-2025-38249](https://cvefeed.io/vuln/detail/CVE-2025-38249)
- [https://cvefeed.io/vuln/detail/CVE-2025-38251](https://cvefeed.io/vuln/detail/CVE-2025-38251)
- [https://cvefeed.io/vuln/detail/CVE-2025-38252](https://cvefeed.io/vuln/detail/CVE-2025-38252)
- [https://cvefeed.io/vuln/detail/CVE-2025-38253](https://cvefeed.io/vuln/detail/CVE-2025-38253)
- [https://cvefeed.io/vuln/detail/CVE-2025-38254](https://cvefeed.io/vuln/detail/CVE-2025-38254)
- [https://cvefeed.io/vuln/detail/CVE-2025-38255](https://cvefeed.io/vuln/detail/CVE-2025-38255)
- [https://cvefeed.io/vuln/detail/CVE-2025-38256](https://cvefeed.io/vuln/detail/CVE-2025-38256)
- [https://cvefeed.io/vuln/detail/CVE-2025-38257](https://cvefeed.io/vuln/detail/CVE-2025-38257)
- [https://cvefeed.io/vuln/detail/CVE-2025-38258](https://cvefeed.io/vuln/detail/CVE-2025-38258)
- [https://cvefeed.io/vuln/detail/CVE-2025-38259](https://cvefeed.io/vuln/detail/CVE-2025-38259)
- [https://cvefeed.io/vuln/detail/CVE-2025-38260](https://cvefeed.io/vuln/detail/CVE-2025-38260)
- [https://cvefeed.io/vuln/detail/CVE-2025-38261](https://cvefeed.io/vuln/detail/CVE-2025-38261)
- [https://cvefeed.io/vuln/detail/CVE-2025-38262](https://cvefeed.io/vuln/detail/CVE-2025-38262)
- [https://cvefeed.io/vuln/detail/CVE-2025-38263](https://cvefeed.io/vuln/detail/CVE-2025-38263)
- [https://cvefeed.io/vuln/detail/CVE-2025-38264](https://cvefeed.io/vuln/detail/CVE-2025-38264)
- [https://cvefeed.io/vuln/detail/CVE-2025-38241](https://cvefeed.io/vuln/detail/CVE-2025-38241)
- [https://cvefeed.io/vuln/detail/CVE-2025-38242](https://cvefeed.io/vuln/detail/CVE-2025-38242)
- [https://cvefeed.io/vuln/detail/CVE-2025-38243](https://cvefeed.io/vuln/detail/CVE-2025-38243)
- [https://cvefeed.io/vuln/detail/CVE-2025-38244](https://cvefeed.io/vuln/detail/CVE-2025-38244)
- [https://cvefeed.io/vuln/detail/CVE-2025-38245](https://cvefeed.io/vuln/detail/CVE-2025-38245)
- [https://cvefeed.io/vuln/detail/CVE-2025-38239](https://cvefeed.io/vuln/detail/CVE-2025-38239)
- [https://cvefeed.io/vuln/detail/CVE-2025-27027](https://cvefeed.io/vuln/detail/CVE-2025-27027)
- [https://cvefeed.io/vuln/detail/CVE-2025-27028](https://cvefeed.io/vuln/detail/CVE-2025-27028)
- [https://cvefeed.io/vuln/detail/CVE-2025-3497](https://cvefeed.io/vuln/detail/CVE-2025-3497)
- [https://cvefeed.io/vuln/detail/CVE-2025-3498](https://cvefeed.io/vuln/detail/CVE-2025-3498)
- [https://cvefeed.io/vuln/detail/CVE-2025-3499](https://cvefeed.io/vuln/detail/CVE-2025-3499)
- [https://cvefeed.io/vuln/detail/CVE-2025-7379](https://cvefeed.io/vuln/detail/CVE-2025-7379)
- [https://cvefeed.io/vuln/detail/CVE-2025-7220](https://cvefeed.io/vuln/detail/CVE-2025-7220)
- [https://cvefeed.io/vuln/detail/CVE-2025-7378](https://cvefeed.io/vuln/detail/CVE-2025-7378)
- [https://cvefeed.io/vuln/detail/CVE-2025-6691](https://cvefeed.io/vuln/detail/CVE-2025-6691)
- [https://cvefeed.io/vuln/detail/CVE-2025-6742](https://cvefeed.io/vuln/detail/CVE-2025-6742)
- [https://cvefeed.io/vuln/detail/CVE-2025-7218](https://cvefeed.io/vuln/detail/CVE-2025-7218)
- [https://cvefeed.io/vuln/detail/CVE-2025-7219](https://cvefeed.io/vuln/detail/CVE-2025-7219)
- [https://cvefeed.io/vuln/detail/CVE-2025-7215](https://cvefeed.io/vuln/detail/CVE-2025-7215)
- [https://cvefeed.io/vuln/detail/CVE-2025-7216](https://cvefeed.io/vuln/detail/CVE-2025-7216)
- [https://cvefeed.io/vuln/detail/CVE-2025-7217](https://cvefeed.io/vuln/detail/CVE-2025-7217)
- [https://cvefeed.io/vuln/detail/CVE-2025-4606](https://cvefeed.io/vuln/detail/CVE-2025-4606)
- [https://cvefeed.io/vuln/detail/CVE-2025-7059](https://cvefeed.io/vuln/detail/CVE-2025-7059)
- [https://cvefeed.io/vuln/detail/CVE-2025-7214](https://cvefeed.io/vuln/detail/CVE-2025-7214)
- [https://cvefeed.io/vuln/detail/CVE-2025-53685](https://cvefeed.io/vuln/detail/CVE-2025-53685)
- [https://cvefeed.io/vuln/detail/CVE-2025-53686](https://cvefeed.io/vuln/detail/CVE-2025-53686)
- [https://cvefeed.io/vuln/detail/CVE-2025-53687](https://cvefeed.io/vuln/detail/CVE-2025-53687)
- [https://cvefeed.io/vuln/detail/CVE-2025-53688](https://cvefeed.io/vuln/detail/CVE-2025-53688)
- [https://cvefeed.io/vuln/detail/CVE-2025-7211](https://cvefeed.io/vuln/detail/CVE-2025-7211)
- [https://cvefeed.io/vuln/detail/CVE-2025-7212](https://cvefeed.io/vuln/detail/CVE-2025-7212)
- [https://cvefeed.io/vuln/detail/CVE-2025-7213](https://cvefeed.io/vuln/detail/CVE-2025-7213)
- [https://cvefeed.io/vuln/detail/CVE-2025-53682](https://cvefeed.io/vuln/detail/CVE-2025-53682)
- [https://cvefeed.io/vuln/detail/CVE-2025-53683](https://cvefeed.io/vuln/detail/CVE-2025-53683)
- [https://cvefeed.io/vuln/detail/CVE-2025-53684](https://cvefeed.io/vuln/detail/CVE-2025-53684)
- [https://cvefeed.io/vuln/detail/CVE-2025-5678](https://cvefeed.io/vuln/detail/CVE-2025-5678)
- [https://cvefeed.io/vuln/detail/CVE-2025-7210](https://cvefeed.io/vuln/detail/CVE-2025-7210)
- [https://cvefeed.io/vuln/detail/CVE-2025-7209](https://cvefeed.io/vuln/detail/CVE-2025-7209)
- [https://cvefeed.io/vuln/detail/CVE-2025-34077](https://cvefeed.io/vuln/detail/CVE-2025-34077)
- [https://cvefeed.io/vuln/detail/CVE-2025-34083](https://cvefeed.io/vuln/detail/CVE-2025-34083)
- [https://cvefeed.io/vuln/detail/CVE-2025-34084](https://cvefeed.io/vuln/detail/CVE-2025-34084)
- [https://cvefeed.io/vuln/detail/CVE-2025-34085](https://cvefeed.io/vuln/detail/CVE-2025-34085)
- [https://cvefeed.io/vuln/detail/CVE-2025-7207](https://cvefeed.io/vuln/detail/CVE-2025-7207)
- [https://cvefeed.io/vuln/detail/CVE-2025-7208](https://cvefeed.io/vuln/detail/CVE-2025-7208)
- [https://cvefeed.io/vuln/detail/CVE-2025-4828](https://cvefeed.io/vuln/detail/CVE-2025-4828)
- [https://cvefeed.io/vuln/detail/CVE-2025-4855](https://cvefeed.io/vuln/detail/CVE-2025-4855)
- [https://cvefeed.io/vuln/detail/CVE-2025-7206](https://cvefeed.io/vuln/detail/CVE-2025-7206)
- [https://cvefeed.io/vuln/detail/CVE-2025-3780](https://cvefeed.io/vuln/detail/CVE-2025-3780)

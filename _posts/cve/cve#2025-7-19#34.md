 
title: cve fuite du 2025-7-19
date: 2025-7-19
lien: "https://cvefeed.io/vuln/detail/CVE-2025-38350"
categories:
  - cve
---

CVE ID : CVE-2025-38350

Published :  July 19
2025
7:15 a.m. | 9 hours
51 minutes ago

Description : In the Linux kernel
the following vulnerability has been resolved:

net/sched: Always pass notifications when child class becomes empty

Certain classful qdiscs may invoke their classes' dequeue handler on an
enqueue operation. This may unexpectedly empty the child qdisc and thus
make an in-flight class passive via qlen_notify(). Most qdiscs do not
expect such behaviour at this point in time and may re-activate the
class eventually anyways which will lead to a use-after-free.

The referenced fix commit attempted to fix this behavior for the HFSC
case by moving the backlog accounting around
though this turned out to
be incomplete since the parent's parent may run into the issue too.
The following reproducer demonstrates this use-after-free:

    tc qdisc add dev lo root handle 1: drr
    tc filter add dev lo parent 1: basic classid 1:1
    tc class add dev lo parent 1: classid 1:1 drr
    tc qdisc add dev lo parent 1:1 handle 2: hfsc def 1
    tc class add dev lo parent 2: classid 2:1 hfsc rt m1 8 d 1 m2 0
    tc qdisc add dev lo parent 2:1 handle 3: netem
    tc qdisc add dev lo parent 3:1 handle 4: blackhole

    echo 1 | socat -u STDIN UDP4-DATAGRAM:127.0.0.1:8888
    tc class delete dev lo classid 1:1
    echo 1 | socat -u STDIN UDP4-DATAGRAM:127.0.0.1:8888

Since backlog accounting issues leading to a use-after-frees on stale
class pointers is a recurring pattern at this point
this patch takes
a different approach. Instead of trying to fix the accounting
the patch
ensures that qdisc_tree_reduce_backlog always calls qlen_notify when
the child qdisc is empty. This solves the problem because deletion of
qdiscs always involves a call to qdisc_reset() and / or
qdisc_purge_queue() which ultimately resets its qlen to 0 thus causing
the following qdisc_tree_reduce_backlog() to report to the parent. Note
that this may call qlen_notify on passive classes multiple times. This
is not a problem after the recent patch series that made all the
classful qdiscs qlen_notify() handlers idempotent.

Severity: 0.0 | NA

Visit the link for more details
such as CVSS details
affected products
timeline
and more...


Autres fuites ce jour :
- [https://cvefeed.io/vuln/detail/CVE-2025-7857](https://cvefeed.io/vuln/detail/CVE-2025-7857)
- [https://cvefeed.io/vuln/detail/CVE-2025-7856](https://cvefeed.io/vuln/detail/CVE-2025-7856)
- [https://cvefeed.io/vuln/detail/CVE-2025-7855](https://cvefeed.io/vuln/detail/CVE-2025-7855)
- [https://cvefeed.io/vuln/detail/CVE-2025-7854](https://cvefeed.io/vuln/detail/CVE-2025-7854)
- [https://cvefeed.io/vuln/detail/CVE-2025-7853](https://cvefeed.io/vuln/detail/CVE-2025-7853)
- [https://cvefeed.io/vuln/detail/CVE-2025-7838](https://cvefeed.io/vuln/detail/CVE-2025-7838)
- [https://cvefeed.io/vuln/detail/CVE-2025-7840](https://cvefeed.io/vuln/detail/CVE-2025-7840)
- [https://cvefeed.io/vuln/detail/CVE-2025-7836](https://cvefeed.io/vuln/detail/CVE-2025-7836)
- [https://cvefeed.io/vuln/detail/CVE-2025-7837](https://cvefeed.io/vuln/detail/CVE-2025-7837)
- [https://cvefeed.io/vuln/detail/CVE-2025-54313](https://cvefeed.io/vuln/detail/CVE-2025-54313)
- [https://cvefeed.io/vuln/detail/CVE-2025-7832](https://cvefeed.io/vuln/detail/CVE-2025-7832)
- [https://cvefeed.io/vuln/detail/CVE-2025-7833](https://cvefeed.io/vuln/detail/CVE-2025-7833)
- [https://cvefeed.io/vuln/detail/CVE-2025-7834](https://cvefeed.io/vuln/detail/CVE-2025-7834)
- [https://cvefeed.io/vuln/detail/CVE-2025-7831](https://cvefeed.io/vuln/detail/CVE-2025-7831)
- [https://cvefeed.io/vuln/detail/CVE-2025-7830](https://cvefeed.io/vuln/detail/CVE-2025-7830)
- [https://cvefeed.io/vuln/detail/CVE-2025-7829](https://cvefeed.io/vuln/detail/CVE-2025-7829)
- [https://cvefeed.io/vuln/detail/CVE-2025-7819](https://cvefeed.io/vuln/detail/CVE-2025-7819)
- [https://cvefeed.io/vuln/detail/CVE-2025-7823](https://cvefeed.io/vuln/detail/CVE-2025-7823)
- [https://cvefeed.io/vuln/detail/CVE-2025-7824](https://cvefeed.io/vuln/detail/CVE-2025-7824)
- [https://cvefeed.io/vuln/detail/CVE-2025-7818](https://cvefeed.io/vuln/detail/CVE-2025-7818)
- [https://cvefeed.io/vuln/detail/CVE-2015-10138](https://cvefeed.io/vuln/detail/CVE-2015-10138)
- [https://cvefeed.io/vuln/detail/CVE-2015-10139](https://cvefeed.io/vuln/detail/CVE-2015-10139)
- [https://cvefeed.io/vuln/detail/CVE-2025-38351](https://cvefeed.io/vuln/detail/CVE-2025-38351)
- [https://cvefeed.io/vuln/detail/CVE-2025-7817](https://cvefeed.io/vuln/detail/CVE-2025-7817)
- [https://cvefeed.io/vuln/detail/CVE-2025-7816](https://cvefeed.io/vuln/detail/CVE-2025-7816)
- [https://cvefeed.io/vuln/detail/CVE-2025-7815](https://cvefeed.io/vuln/detail/CVE-2025-7815)
- [https://cvefeed.io/vuln/detail/CVE-2015-10135](https://cvefeed.io/vuln/detail/CVE-2015-10135)
- [https://cvefeed.io/vuln/detail/CVE-2015-10136](https://cvefeed.io/vuln/detail/CVE-2015-10136)
- [https://cvefeed.io/vuln/detail/CVE-2016-15043](https://cvefeed.io/vuln/detail/CVE-2016-15043)
- [https://cvefeed.io/vuln/detail/CVE-2015-10134](https://cvefeed.io/vuln/detail/CVE-2015-10134)
- [https://cvefeed.io/vuln/detail/CVE-2012-10019](https://cvefeed.io/vuln/detail/CVE-2012-10019)
- [https://cvefeed.io/vuln/detail/CVE-2015-10133](https://cvefeed.io/vuln/detail/CVE-2015-10133)
- [https://cvefeed.io/vuln/detail/CVE-2025-6997](https://cvefeed.io/vuln/detail/CVE-2025-6997)
- [https://cvefeed.io/vuln/detail/CVE-2025-6721](https://cvefeed.io/vuln/detail/CVE-2025-6721)
- [https://cvefeed.io/vuln/detail/CVE-2025-29757](https://cvefeed.io/vuln/detail/CVE-2025-29757)
- [https://cvefeed.io/vuln/detail/CVE-2025-6720](https://cvefeed.io/vuln/detail/CVE-2025-6720)
- [https://cvefeed.io/vuln/detail/CVE-2025-7697](https://cvefeed.io/vuln/detail/CVE-2025-7697)
- [https://cvefeed.io/vuln/detail/CVE-2025-7696](https://cvefeed.io/vuln/detail/CVE-2025-7696)
- [https://cvefeed.io/vuln/detail/CVE-2025-7669](https://cvefeed.io/vuln/detail/CVE-2025-7669)
- [https://cvefeed.io/vuln/detail/CVE-2025-7653](https://cvefeed.io/vuln/detail/CVE-2025-7653)
- [https://cvefeed.io/vuln/detail/CVE-2025-7655](https://cvefeed.io/vuln/detail/CVE-2025-7655)
- [https://cvefeed.io/vuln/detail/CVE-2025-7658](https://cvefeed.io/vuln/detail/CVE-2025-7658)
- [https://cvefeed.io/vuln/detail/CVE-2025-7661](https://cvefeed.io/vuln/detail/CVE-2025-7661)
- [https://cvefeed.io/vuln/detail/CVE-2025-52924](https://cvefeed.io/vuln/detail/CVE-2025-52924)

---
title: CVE-2025-38172
date: 2025-7-3
lien: "https://cvefeed.io/vuln/detail/CVE-2025-38172"
categories:
  - cve
---

CVE ID : CVE-2025-38172

Published :  July 3
2025
9:15 a.m. | 2 hours
57 minutes ago

Description : In the Linux kernel
the following vulnerability has been resolved:

erofs: avoid using multiple devices with different type

For multiple devices
both primary and extra devices should be the
same type. `erofs_init_device` has already guaranteed that if the
primary is a file-backed device
extra devices should also be
regular files.

However
if the primary is a block device while the extra device
is a file-backed device
`erofs_init_device` will get an ENOTBLK
which is not treated as an error in `erofs_fc_get_tree`
and that
leads to an UAF:

  erofs_fc_get_tree
    get_tree_bdev_flags(erofs_fc_fill_super)
      erofs_read_superblock
        erofs_init_device  // sbi->dif0 is not inited yet
// return -ENOTBLK
      deactivate_locked_super
        free(sbi)
    if (err is -ENOTBLK)
      sbi->dif0.file = filp_open()  // sbi UAF

So if -ENOTBLK is hitted in `erofs_init_device`
it means the
primary device must be a block device
and the extra device
is not a block device. The error can be converted to -EINVAL.

Severity: 0.0 | NA

Visit the link for more details
such as CVSS details
affected products
timeline
and more...
